<purpose>
在规划之前展示 Claude 对阶段的假设，使用户能够及早纠正误解。

与 discuss-phase 的主要区别：这是对 Claude 思考的分析，而不是对用户知识的输入。无文件输出 - 纯对话式以促进讨论。
</purpose>

<process>

<step name="validate_phase" priority="first">
阶段编号：$ARGUMENTS（必需）

**如果缺少参数：**

```
错误：需要阶段编号。

用法：/gsd:list-phase-assumptions [phase-number]
示例：/gsd:list-phase-assumptions 3
```

退出工作流程。

**如果提供了参数：**
验证路线图中是否存在阶段：

```bash
cat .planning/ROADMAP.md | grep -i "Phase ${PHASE}"
```

**如果未找到阶段：**

```
错误：在路线图中未找到阶段 ${PHASE}。

可用阶段：
[列出路线图中的阶段]
```

退出工作流程。

**如果找到阶段：**
从路线图解析阶段详细信息：

- 阶段编号
- 阶段名称
- 阶段描述/目标
- 提到的任何范围详细信息

继续到 analyze_phase。
</step>

<step name="analyze_phase">
基于路线图描述和项目上下文，识别五个领域的假设：

**1. 技术方法：**
Claude 会使用哪些库、框架、模式或工具？
- "我会使用 X 库，因为..."
- "我会遵循 Y 模式，因为..."
- "我会将其结构化为 Z，因为..."

**2. 实现顺序：**
Claude 会先、第二、第三构建什么？
- "我会从 X 开始，因为它是基础"
- "然后是 Y，因为它依赖于 X"
- "最后是 Z，因为..."

**3. 范围边界：**
在 Claude 的解释中包括什么 vs 排除什么？
- "此阶段包括：A、B、C"
- "此阶段不包括：D、E、F"
- "边界歧义：G 可能是任一种方式"

**4. 风险区域：**
Claude 在哪里预期复杂性或挑战？
- "棘手的部分是 X，因为..."
- "潜在问题：Y、Z"
- "我会注意..."

**5. 依赖项：**
Claude 假设存在什么或需要什么？
- "这假设来自先前阶段的 X"
- "外部依赖项：Y、Z"
- "这将被...消费"

对不确定性保持诚实。用置信度级别标记假设：
- "相当自信：..."（从路线图清晰）
- "假设：..."（合理推断）
- "不清楚：..."（可能是多种方式）
</step>

<step name="present_assumptions">
以清晰、可扫描的格式展示假设：

```
## 我对阶段 ${PHASE} 的假设：${PHASE_NAME}

### 技术方法
[列出关于如何实现的假设]

### 实现顺序
[列出关于排序的假设]

### 范围边界
**范围内：** [包括的内容]
**范围外：** [排除的内容]
**模糊：** [可能任一种方式的内容]

### 风险区域
[列出预期挑战]

### 依赖项
**来自先前阶段：** [需要什么]
**外部：** [第三方需求]
**输入到：** [未来阶段从此需要什么]

---

**您怎么看？**

这些假设准确吗？让我知道：
- 我对的部分
- 我错的部分
- 我缺少的部分
```

等待用户响应。
</step>

<step name="gather_feedback">
**如果用户提供更正：**

确认更正：

```
关键更正：
- [更正 1]
- [更正 2]

这显著改变了我的理解。[总结新理解]
```

**如果用户确认假设：**

```
假设已验证。
```

继续到 offer_next。
</step>

<step name="offer_next">
展示下一步：

```
下一步是什么？
1. 讨论上下文 (/gsd:discuss-phase ${PHASE}) - 让我向您提问以构建综合上下文
2. 规划此阶段 (/gsd:plan-phase ${PHASE}) - 创建详细执行计划
3. 重新检查假设 - 我将使用您的更正再次分析
4. 暂时完成
```

等待用户选择。

如果 "讨论上下文"：注意 CONTEXT.md 将合并在此讨论的任何更正
如果 "规划此阶段"：继续知道假设已理解
如果 "重新检查"：使用更新的理解返回 analyze_phase
</step>

</process>

<success_criteria>
- 阶段编号已根据路线图验证
- 假设已在五个领域展示：技术方法、实现顺序、范围、风险、依赖项
- 置信度级别已在适当位置标记
- "您怎么看？" 提示已展示
- 用户反馈已确认
- 已提供清晰的下一步
</success_criteria>
